(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{397:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("同Job一样，trigger非常容易使用，但它有一些可选项需要注意和理解，同时，trigger有不同的类型，要按照需求进行选择。")]),t._v(" "),a("h2",{attrs:{id:"通用触发器属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通用触发器属性"}},[t._v("#")]),t._v(" 通用触发器属性")]),t._v(" "),a("p",[t._v("除了所有触发器类型都有用于跟踪其身份的"),a("code",[t._v("TriggerKey")]),t._v(" 属性之外，\n还有许多其他属性是所有触发器类型通用的。这些公共属性是使用TriggerBuilder设置的\n当您构建触发器定义时（下面将给出示例）。")]),t._v(" "),a("p",[t._v("以下是所有触发器类型通用的属性列表:")]),t._v(" "),a("ul",[a("li",[a("ol",[a("li",[a("code",[t._v("JobKey")]),t._v("  触发器触发时应执行的job的标识")])])]),t._v(" "),a("li",[a("ol",{attrs:{start:"2"}},[a("li",[a("code",[t._v("StartTimeUtc")]),t._v(" 指触发器的时间表何时首次生效\n该值是DateTimeOffset对象，该对象定义给定日历日期的时间点。\n对于某些触发器类型，触发器实际上将在开始时间触发，对于其他触发器，它仅标记应开始遵循时间表的时间。\n这意味着您可以在1月期间存储带有时间表的触发器，例如“每月的第5天”，如果StartTimeUtc属性设置为4月1日，则代表离第一次触发还有好几个月")])])]),t._v(" "),a("li",[a("ol",{attrs:{start:"3"}},[a("li",[a("code",[t._v("EndTimeUtc")]),t._v(" 指示触发器的计划何时不再有效。\n换句话说，一个时间表为“每月第五天”、结束时间为7月1日的触发器将在6月5日触发最后一次。")])])])]),t._v(" "),a("p",[t._v("其他属性，需要更多的解释，将在下面的小节中讨论。")]),t._v(" "),a("h2",{attrs:{id:"优先权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优先权"}},[t._v("#")]),t._v(" 优先权")]),t._v(" "),a("p",[t._v("有时候，当你有很多触发器（或Quartz.NET线程池中的工作线程很少）时，Quartz.NET可能没有足够的资源立即启动所有计划同时触发的触发器。在这种情况下，您可能需要控制哪些触发器在可用的的Quartz.NET工作线程中首先被调用。为此，可以在触发器上设置priority属性。如果要同时触发N个触发器，但当前只有Z个工作线程可用，那么将首先执行具有最高优先级的第一个Z触发器。如果您没有在触发器上设置优先级，那么它将使用默认优先级5。优先级允许任何整数值（正或负）。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("仅当触发器具有相同的触发时间时才比较优先级。 计划在10:59触发的触发器将始终在计划在11:00触发的触发器之前触发")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("当检测到触发器的作业需要恢复时，将使用与原始触发器相同的优先级计划其恢复")])]),t._v(" "),a("h2",{attrs:{id:"未触发指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#未触发指令"}},[t._v("#")]),t._v(" 未触发指令")]),t._v(" "),a("p",[t._v("触发器另一个重要属性是 \"misfire instruction\". 如果由于调度程序关闭而导致持久性触发器“错过”其触发时间，则会发生不触发事件，\n或因为Quartz.NET的线程池中没有可用的线程来执行作业。\n不同的触发器类型具有不同的未触发指令。\n默认情况下，它们使用'smart policy'指令-该指令具有基于触发器类型和配置的动态行为。\n调度程序启动时，它将搜索所有未触发的持久性触发器，然后根据它们各自的更新它们。\n配置未触发指令。 当您开始在自己的项目中使用Quartz.NET时，应该使自己熟悉未触发指令。\n它们是在给定的触发器类型上定义的，并在其API文档中进行了说明。 有关未触发指令的更多具体信息将在\n针对每种触发器类型的教程课程。")]),t._v(" "),a("h2",{attrs:{id:"日历"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#日历"}},[t._v("#")]),t._v(" 日历")]),t._v(" "),a("p",[t._v("实现"),a("code",[t._v("ICalendar")]),t._v("接口的Quartz.NET Calendar对象可以在触发器存储在调度程序中时与触发器相关联。\n日历对于从触发器的触发计划中排除时间段很有用。"),a("br"),t._v("\n例如，您可以创建一个触发器，该触发器在每个工作日的上午9:30触发工作，然后添加一个排除所有企业假期的日历。")]),t._v(" "),a("p",[t._v("日历可以是实现ICalendar接口的任何可序列化对象，如下所示：")]),t._v(" "),a("div",{staticClass:"language-csharp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("Quartz")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ICalendar")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),t._v(" Description "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("ICalendar")]),t._v(" CalendarBase "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("IsTimeIncluded")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DateTimeOffset")]),t._v(" timeUtc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("DateTime")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetNextIncludedTimeUtc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DateTimeOffset")]),t._v(" timeUtc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("ICalendar")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Clone")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n")])])]),a("p",[t._v("即使日历可以'block out'最短毫秒的时间段，最有可能的是，您还是会对'block out'整天感兴趣。 为了方便起见，Quartz.NET包括了HolidayCalendar类，它就是这样做的。")]),t._v(" "),a("p",[t._v("必须实例化日历，并通过AddCalendar（..）方法向计划程序注册日历。 如果使用"),a("code",[t._v("HolidayCalendar")]),t._v("，则在实例化它之后，应使用其AddExcludedDate（DateTime date）方法，以使用希望从计划中排除的日期填充它。\n同一日历实例可以与多个触发器一起使用，例如：")]),t._v(" "),a("p",[a("strong",[t._v("Calendar Example")])]),t._v(" "),a("div",{staticClass:"language-csharp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HolidayCalendar")]),t._v(" cal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("HolidayCalendar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    cal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddExcludedDate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("someDate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" sched"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddCalendar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myHolidays"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n\t"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ITrigger")]),t._v(" t "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TriggerBuilder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("WithIdentity")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myTrigger"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ForJob")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myJob"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("WithSchedule")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CronScheduleBuilder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("DailyAtHourAndMinute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// execute job daily at 9:30")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ModifiedByCalendar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myHolidays"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// but not on holidays")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// .. schedule job with trigger")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ITrigger")]),t._v(" t2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TriggerBuilder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("WithIdentity")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myTrigger2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ForJob")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myJob2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("WithSchedule")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CronScheduleBuilder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("DailyAtHourAndMinute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// execute job daily at 11:30")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ModifiedByCalendar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myHolidays"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// but not on holidays")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// .. schedule job with trigger2 ")]),t._v("\n")])])]),a("p",[t._v("在接下来的两节课中将详细介绍触发器的构造/构建。"),a("br"),t._v("\n现在，仅需相信上面的代码创建了两个触发器，每个触发器都计划每天触发。 但是，将跳过在日历排除的期间内发生的任何触发。")]),t._v(" "),a("p",[t._v("请参阅Quartz.Impl.Calendar命名空间，以获取许多可能满足您需求的ICalendar实现。")])])}),[],!1,null,null,null);s.default=e.exports}}]);