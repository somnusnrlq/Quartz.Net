(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{394:function(t,s,e){"use strict";e.r(s);var a=e(42),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("Listeners 是你创建的用于根据调度程序中发生的事件执行的操作对象，\n您可能会猜到，TriggerListener接收与触发器相关的事件，而JobListeners接收与作业相关的事件。"),e("br"),t._v("\nListeners are objects that you create to perform actions based on events occuring within the scheduler.\nAs you can probably guess, TriggerListeners receive events related to triggers, and JobListeners receive events related to jobs.")]),t._v(" "),e("p",[t._v("与触发器相关的事件包括：触发器触发，触发器误触发（在本文档的“触发器”部分中讨论）和完成触发器（触发器触发的作业已完成）"),e("br"),t._v('\nTrigger-related events include: trigger firings, trigger mis-firings (discussed in the "Triggers" section of this document),\nand trigger completions (the jobs fired off by the trigger is finished).')]),t._v(" "),e("div",{staticClass:"custom-block danger"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("确保触发器和作业侦听器不会引发异常（使用try-catch），并且它们可以处理内部问题。\n当侦听器通知失败时，Quartz无法确定侦听器中所需的逻辑是否成功完成之后，作业可能会卡住"),e("br"),t._v("\nMake sure your trigger and job listeners never throw an exception (use a try-catch) and that they can handle internal problems.\nJobs can get stuck after Quartz is unable to determine whether required logic in listener was completed successfully when listener notification failed.")])]),t._v(" "),e("p",[e("strong",[t._v("ITriggerListener 接口")])]),t._v(" "),e("div",{staticClass:"language-csharp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-csharp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ITriggerListener")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t "),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),t._v(" Name "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t \n\t "),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Task")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("TriggerFired")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ITrigger")]),t._v(" trigger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IJobExecutionContext")]),t._v(" context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t \n\t "),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Task"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bool")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("VetoJobExecution")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ITrigger")]),t._v(" trigger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IJobExecutionContext")]),t._v(" context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t \n\t "),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Task")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("TriggerMisfired")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ITrigger")]),t._v(" trigger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t \n\t "),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Task")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("TriggerComplete")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ITrigger")]),t._v(" trigger"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IJobExecutionContext")]),t._v(" context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")])]),t._v(" triggerInstructionCode"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("与作业相关的事件包括：即将执行作业的通知，以及作业完成执行时的通知"),e("br"),t._v("\nJob-related events include: a notification that the job is about to be executed, and a notification when the job has completed execution.")]),t._v(" "),e("p",[e("strong",[t._v("IJobListener 接口")])]),t._v(" "),e("div",{staticClass:"language-csharp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-csharp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IJobListener")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),t._v(" Name "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Task")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("JobToBeExecuted")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IJobExecutionContext")]),t._v(" context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Task")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("JobExecutionVetoed")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IJobExecutionContext")]),t._v(" context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Task")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("JobWasExecuted")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IJobExecutionContext")]),t._v(" context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JobExecutionException")]),t._v(" jobException"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n")])])]),e("h2",{attrs:{id:"自己创建-listeners"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自己创建-listeners"}},[t._v("#")]),t._v(" 自己创建 Listeners")]),t._v(" "),e("p",[t._v("要创建一个侦听器，只需创建一个对象，该对象将实现"),e("code",[t._v("ITriggerListener")]),t._v(" 和/或  "),e("code",[t._v("IJobListener")]),t._v(" 接口。\n然后，在运行时将侦听器注册到调度程序，通过其Name属性给其指定名称（或者，它们必须公告自己的名称）"),e("br"),t._v("\nTo create a listener, simply create an object the implements either the "),e("code",[t._v("ITriggerListener")]),t._v(" and/or "),e("code",[t._v("IJobListener")]),t._v(" interface.\nListeners are then registered with the scheduler during run time, and must be given a name (or rather, they must advertise their own\nname via their Name property.")]),t._v(" "),e("p",[t._v("为了方便起见，您的类也可以扩展类"),e("code",[t._v("JobListenerSupport")]),t._v("或"),e("code",[t._v("TriggerListenerSupport")]),t._v("，而不是实现这些接口。\n并简单地覆盖您感兴趣的事件"),e("br"),t._v("\nFor your convenience, rather than implementing those interfaces, your class could also extend the class "),e("code",[t._v("JobListenerSupport")]),t._v(" or "),e("code",[t._v("TriggerListenerSupport")]),t._v("\nand simply override the events you're interested in.")]),t._v(" "),e("p",[t._v("侦听器与调度程序的"),e("code",[t._v("ListenerManager'一起注册，该Matcher描述了侦听器要为其接收事件的作业/触发器 Listeners are registered with the scheduler's")]),t._v("ListenerManager` along with a Matcher that describes which Jobs/Triggers the listener wants to receive events for.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("侦听器在运行时会在调度程序中注册，并且不会与作业和触发器一起存储在JobStore中。\n这是因为侦听器是你的应用程序的集成点。\n因此，每次应用程序运行时，都需要在调度程序中重新注册侦听器"),e("br"),t._v("\nListeners are registered with the scheduler during run time, and are "),e("strong",[t._v("NOT")]),t._v(" stored in the JobStore along with the jobs and triggers.\nThis is because listeners are typically an integration point with your application.\nHence, each time your application runs, the listeners need to be re-registered with the scheduler.")])]),t._v(" "),e("p",[e("strong",[t._v("对特定作业添加相关JobListener:")])]),t._v(" "),e("div",{staticClass:"language-csharp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-csharp"}},[e("code",[t._v("scheduler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListenerManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddJobListener")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("myJobListener"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" KeyMatcher"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("JobKey"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("KeyEquals")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("JobKey")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myJobName"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myJobGroup"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("strong",[t._v("对特定组的所有作业添加相关JobListener:")])]),t._v(" "),e("div",{staticClass:"language-csharp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-csharp"}},[e("code",[t._v("scheduler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListenerManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddJobListener")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("myJobListener"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" GroupMatcher"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("JobKey"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("GroupEquals")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myJobGroup"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("strong",[t._v("对两个特定组的所有作业添加相关JobListener:")])]),t._v(" "),e("div",{staticClass:"language-csharp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-csharp"}},[e("code",[t._v("scheduler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListenerManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddJobListener")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("myJobListener"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\tOrMatcher"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("JobKey"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Or")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GroupMatcher"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("JobKey"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("GroupEquals")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myJobGroup"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" GroupMatcher"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("JobKey"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("GroupEquals")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yourGroup"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("strong",[t._v("对所有作业添加相关JobListener：")])]),t._v(" "),e("div",{staticClass:"language-csharp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-csharp"}},[e("code",[t._v("scheduler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListenerManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddJobListener")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("myJobListener"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" GroupMatcher"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("JobKey"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("AnyGroup")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Quartz.NET的大多数用户并不使用侦听器，但是当应用程序需求引起需求时，侦听器非常方便\n通知事件，而作业本身未明确通知应用程序。")])])}),[],!1,null,null,null);s.default=n.exports}}]);